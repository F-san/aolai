"use strict";$(function(){var i=localStorage.getItem("uid");function p(){var t=0;$(".num-change").each(function(){t+=parseInt($(this).val())}),$(".cart-number").html(t)}$.ajax({type:"GET",url:"http://jx.xuzhixiang.top/ap/api/cart-list.php",data:{id:i},success:function(t){var e=t.data,a="";function c(){var a=0;$(".checkone").each(function(t){$(this).prop("checked")&&(a+=+$(".num-change").eq(t).val()*e[t].pprice)}),$(".numPrice").html("￥"+a)}function n(t){$.ajax({type:"GET",url:"http://jx.xuzhixiang.top/ap/api/cart-delete.php",data:{uid:i,pid:t}})}$(e).each(function(t){a+="\n                    <tr class='proID' data-id='".concat(e[t].pid,"'>\n                    <td width='60'><input class='checkone' type='checkbox' data-id='").concat(e[t].pid,"'></td>\n                    <td width='540'>\n                        <img src='").concat(e[t].pimg,"'\n                            alt=''>\n                        <a href='detail.html?id=").concat(e[t].pid,"'><p>").concat(e[t].pname,"</p></a>\n                    </td>\n                    <td width='120'>￥").concat(e[t].pprice,"</td>\n                    <td width='120'>\n                        <div class='cart-change-num' data-i = '").concat(t,"'>\n                            <span>-</span><input class='num-change' type='text' value='").concat(e[t].pnum,"'><span>+</span>\n                        </div>\n                    </td>\n                    <td width='120'>优惠</td>\n                    <td width='120' class='cart-sprice' data-id=").concat(e[t].pid,">￥").concat(e[t].pnum*e[t].pprice,"</td>\n                    <td width='120' class='cart-del' data-id='").concat(e[t].pid,"'>删除</td>\n                </tr>\n                    ")}),$(a).appendTo($(".cart-container-main table")),p(),$(".cart-change-num>span:first-child").click(function(){var t,a=$(this).parent().attr("data-i"),c=$(this).parent().parent().parent().attr("data-id"),n=parseInt($(this).next().val())-1;n<1&&(n=1),t=c,c=n,$.ajax({type:"GET",url:"http://jx.xuzhixiang.top/ap/api/cart-update-num.php",data:{uid:i,pid:t,pnum:c}}),$(this).next().val(n),$(this).parent().parent().next().next().html("￥"+e[a].pprice*n),p()}),$(".cart-change-num>span:last-child").click(function(){var t,a=$(this).parent().attr("data-i"),c=$(this).parent().parent().parent().attr("data-id"),n=parseInt($(this).prev().val())+1;t=c,c=n,$.ajax({type:"GET",url:"http://jx.xuzhixiang.top/ap/api/cart-update-num.php",data:{uid:i,pid:t,pnum:c}}),$(this).prev().val(n),$(this).parent().parent().next().next().html("￥"+e[a].pprice*n),p()}),$(".checkAll").click(function(){$(".checkone").each(function(t){$(this).prop("checked",function(){return $(".checkAll").prop("checked")}),c()})}),$(".checkone").each(function(){$(this).click(function(){var t=0;$(".checkone").each(function(){$(this).prop("checked")&&t++}),t==$(".checkone").length?$(".checkAll").prop("checked",!0):$(".checkAll").prop("checked",!1),c()})}),$(".cart-del").each(function(){var t=this;$(this).click(function(){n($(t).attr("data-id")),$(t).parent().remove(),p()})}),$(".checkone").each(function(){var t=this;$(".cart-delAll").click(function(){$(t).prop("checked")&&(n($(t).attr("data-id")),$(t).parent().parent().remove(),$(".numPrice").html(0)),p()})})}})});